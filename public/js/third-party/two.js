(function(){var t=this,e=t._,n={},i=Array.prototype,r=Object.prototype,o=Function.prototype,s=i.push,a=i.slice,c=i.concat,l=r.toString,u=r.hasOwnProperty,h=i.forEach,f=i.map,d=i.reduce,p=i.reduceRight,m=i.filter,g=i.every,_=i.some,v=i.indexOf,y=i.lastIndexOf,x=Array.isArray,b=Object.keys,w=o.bind,A=function(t){return t instanceof A?t:this instanceof A?void(this._wrapped=t):new A(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=A),exports._=A):t._=A,A.VERSION="1.5.1";var T=A.each=A.forEach=function(t,e,i){if(null!=t)if(h&&t.forEach===h)t.forEach(e,i);else if(t.length===+t.length){for(var r=0,o=t.length;o>r;r++)if(e.call(i,t[r],r,t)===n)return}else for(var s in t)if(A.has(t,s)&&e.call(i,t[s],s,t)===n)return};A.map=A.collect=function(t,e,n){var i=[];return null==t?i:f&&t.map===f?t.map(e,n):(T(t,function(t,r,o){i.push(e.call(n,t,r,o))}),i)};var E="Reduce of empty array with no initial value";A.reduce=A.foldl=A.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return i&&(e=A.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(T(t,function(t,o,s){r?n=e.call(i,n,t,o,s):(n=t,r=!0)}),!r)throw new TypeError(E);return n},A.reduceRight=A.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return i&&(e=A.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var s=A.keys(t);o=s.length}if(T(t,function(a,c,l){c=s?s[--o]:--o,r?n=e.call(i,n,t[c],c,l):(n=t[c],r=!0)}),!r)throw new TypeError(E);return n},A.find=A.detect=function(t,e,n){var i;return F(t,function(t,r,o){return e.call(n,t,r,o)?(i=t,!0):void 0}),i},A.filter=A.select=function(t,e,n){var i=[];return null==t?i:m&&t.filter===m?t.filter(e,n):(T(t,function(t,r,o){e.call(n,t,r,o)&&i.push(t)}),i)},A.reject=function(t,e,n){return A.filter(t,function(t,i,r){return!e.call(n,t,i,r)},n)},A.every=A.all=function(t,e,i){e||(e=A.identity);var r=!0;return null==t?r:g&&t.every===g?t.every(e,i):(T(t,function(t,o,s){return(r=r&&e.call(i,t,o,s))?void 0:n}),!!r)};var F=A.some=A.any=function(t,e,i){e||(e=A.identity);var r=!1;return null==t?r:_&&t.some===_?t.some(e,i):(T(t,function(t,o,s){return r||(r=e.call(i,t,o,s))?n:void 0}),!!r)};A.contains=A.include=function(t,e){return null==t?!1:v&&t.indexOf===v?-1!=t.indexOf(e):F(t,function(t){return t===e})},A.invoke=function(t,e){var n=a.call(arguments,2),i=A.isFunction(e);return A.map(t,function(t){return(i?e:t[e]).apply(t,n)})},A.pluck=function(t,e){return A.map(t,function(t){return t[e]})},A.where=function(t,e,n){return A.isEmpty(e)?n?void 0:[]:A[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},A.findWhere=function(t,e){return A.where(t,e,!0)},A.max=function(t,e,n){if(!e&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&A.isEmpty(t))return-(1/0);var i={computed:-(1/0),value:-(1/0)};return T(t,function(t,r,o){var s=e?e.call(n,t,r,o):t;s>i.computed&&(i={value:t,computed:s})}),i.value},A.min=function(t,e,n){if(!e&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&A.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return T(t,function(t,r,o){var s=e?e.call(n,t,r,o):t;s<i.computed&&(i={value:t,computed:s})}),i.value},A.shuffle=function(t){var e,n=0,i=[];return T(t,function(t){e=A.random(n++),i[n-1]=i[e],i[e]=t}),i};var C=function(t){return A.isFunction(t)?t:function(e){return e[t]}};A.sortBy=function(t,e,n){var i=C(e);return A.pluck(A.map(t,function(t,e,r){return{value:t,index:e,criteria:i.call(n,t,e,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index<e.index?-1:1}),"value")};var S=function(t,e,n,i){var r={},o=C(null==e?A.identity:e);return T(t,function(e,s){var a=o.call(n,e,s,t);i(r,a,e)}),r};A.groupBy=function(t,e,n){return S(t,e,n,function(t,e,n){(A.has(t,e)?t[e]:t[e]=[]).push(n)})},A.countBy=function(t,e,n){return S(t,e,n,function(t,e){A.has(t,e)||(t[e]=0),t[e]++})},A.sortedIndex=function(t,e,n,i){n=null==n?A.identity:C(n);for(var r=n.call(i,e),o=0,s=t.length;s>o;){var a=o+s>>>1;n.call(i,t[a])<r?o=a+1:s=a}return o},A.toArray=function(t){return t?A.isArray(t)?a.call(t):t.length===+t.length?A.map(t,A.identity):A.values(t):[]},A.size=function(t){return null==t?0:t.length===+t.length?t.length:A.keys(t).length},A.first=A.head=A.take=function(t,e,n){return null!=t?null==e||n?t[0]:a.call(t,0,e):void 0},A.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},A.last=function(t,e,n){return null!=t?null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0)):void 0},A.rest=A.tail=A.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},A.compact=function(t){return A.filter(t,A.identity)};var k=function(t,e,n){return e&&A.every(t,A.isArray)?c.apply(n,t):(T(t,function(t){A.isArray(t)||A.isArguments(t)?e?s.apply(n,t):k(t,e,n):n.push(t)}),n)};A.flatten=function(t,e){return k(t,e,[])},A.without=function(t){return A.difference(t,a.call(arguments,1))},A.uniq=A.unique=function(t,e,n,i){A.isFunction(e)&&(i=n,n=e,e=!1);var r=n?A.map(t,n,i):t,o=[],s=[];return T(r,function(n,i){(e?i&&s[s.length-1]===n:A.contains(s,n))||(s.push(n),o.push(t[i]))}),o},A.union=function(){return A.uniq(A.flatten(arguments,!0))},A.intersection=function(t){var e=a.call(arguments,1);return A.filter(A.uniq(t),function(t){return A.every(e,function(e){return A.indexOf(e,t)>=0})})},A.difference=function(t){var e=c.apply(i,a.call(arguments,1));return A.filter(t,function(t){return!A.contains(e,t)})},A.zip=function(){for(var t=A.max(A.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=A.pluck(arguments,""+n);return e},A.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},A.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=A.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(v&&t.indexOf===v)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},A.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(y&&t.lastIndexOf===y)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var r=i?n:t.length;r--;)if(t[r]===e)return r;return-1},A.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,o=new Array(i);i>r;)o[r++]=t,t+=n;return o};var R=function(){};A.bind=function(t,e){var n,i;if(w&&t.bind===w)return w.apply(t,a.call(arguments,1));if(!A.isFunction(t))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));R.prototype=t.prototype;var r=new R;R.prototype=null;var o=t.apply(r,n.concat(a.call(arguments)));return Object(o)===o?o:r}},A.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},A.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return T(e,function(e){t[e]=A.bind(t[e],t)}),t},A.memoize=function(t,e){var n={};return e||(e=A.identity),function(){var i=e.apply(this,arguments);return A.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},A.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},A.defer=function(t){return A.delay.apply(A,[t,1].concat(a.call(arguments,1)))},A.throttle=function(t,e,n){var i,r,o,s=null,a=0;n||(n={});var c=function(){a=n.leading===!1?0:new Date,s=null,o=t.apply(i,r)};return function(){var l=new Date;a||n.leading!==!1||(a=l);var u=e-(l-a);return i=this,r=arguments,0>=u?(clearTimeout(s),s=null,a=l,o=t.apply(i,r)):s||n.trailing===!1||(s=setTimeout(c,u)),o}},A.debounce=function(t,e,n){var i,r=null;return function(){var o=this,s=arguments,a=function(){r=null,n||(i=t.apply(o,s))},c=n&&!r;return clearTimeout(r),r=setTimeout(a,e),c&&(i=t.apply(o,s)),i}},A.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},A.wrap=function(t,e){return function(){var n=[t];return s.apply(n,arguments),e.apply(this,n)}},A.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},A.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},A.keys=b||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)A.has(t,n)&&e.push(n);return e},A.values=function(t){var e=[];for(var n in t)A.has(t,n)&&e.push(t[n]);return e},A.pairs=function(t){var e=[];for(var n in t)A.has(t,n)&&e.push([n,t[n]]);return e},A.invert=function(t){var e={};for(var n in t)A.has(t,n)&&(e[t[n]]=n);return e},A.functions=A.methods=function(t){var e=[];for(var n in t)A.isFunction(t[n])&&e.push(n);return e.sort()},A.extend=function(t){return T(a.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},A.pick=function(t){var e={},n=c.apply(i,a.call(arguments,1));return T(n,function(n){n in t&&(e[n]=t[n])}),e},A.omit=function(t){var e={},n=c.apply(i,a.call(arguments,1));for(var r in t)A.contains(n,r)||(e[r]=t[r]);return e},A.defaults=function(t){return T(a.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},A.clone=function(t){return A.isObject(t)?A.isArray(t)?t.slice():A.extend({},t):t},A.tap=function(t,e){return e(t),t};var M=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof A&&(t=t._wrapped),e instanceof A&&(e=e._wrapped);var r=l.call(t);if(r!=l.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return i[o]==e;var s=t.constructor,a=e.constructor;if(s!==a&&!(A.isFunction(s)&&s instanceof s&&A.isFunction(a)&&a instanceof a))return!1;n.push(t),i.push(e);var c=0,u=!0;if("[object Array]"==r){if(c=t.length,u=c==e.length)for(;c--&&(u=M(t[c],e[c],n,i)););}else{for(var h in t)if(A.has(t,h)&&(c++,!(u=A.has(e,h)&&M(t[h],e[h],n,i))))break;if(u){for(h in e)if(A.has(e,h)&&!c--)break;u=!c}}return n.pop(),i.pop(),u};A.isEqual=function(t,e){return M(t,e,[],[])},A.isEmpty=function(t){if(null==t)return!0;if(A.isArray(t)||A.isString(t))return 0===t.length;for(var e in t)if(A.has(t,e))return!1;return!0},A.isElement=function(t){return!(!t||1!==t.nodeType)},A.isArray=x||function(t){return"[object Array]"==l.call(t)},A.isObject=function(t){return t===Object(t)},T(["Arguments","Function","String","Number","Date","RegExp"],function(t){A["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),A.isArguments(arguments)||(A.isArguments=function(t){return!(!t||!A.has(t,"callee"))}),"function"!=typeof/./&&(A.isFunction=function(t){return"function"==typeof t}),A.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},A.isNaN=function(t){return A.isNumber(t)&&t!=+t},A.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},A.isNull=function(t){return null===t},A.isUndefined=function(t){return void 0===t},A.has=function(t,e){return u.call(t,e)},A.noConflict=function(){return t._=e,this},A.identity=function(t){return t},A.times=function(t,e,n){for(var i=Array(Math.max(0,t)),r=0;t>r;r++)i[r]=e.call(n,r);return i},A.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};P.unescape=A.invert(P.escape);var U={escape:new RegExp("["+A.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+A.keys(P.unescape).join("|")+")","g")};A.each(["escape","unescape"],function(t){A[t]=function(e){return null==e?"":(""+e).replace(U[t],function(e){return P[t][e]})}}),A.result=function(t,e){if(null!=t){var n=t[e];return A.isFunction(n)?n.call(t):n}},A.mixin=function(t){T(A.functions(t),function(e){var n=A[e]=t[e];A.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),V.call(this,n.apply(A,t))}})};var j=0;A.uniqueId=function(t){var e=++j+"";return t?t+e:e},A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;A.template=function(t,e,n){var i;n=A.defaults({},n,A.templateSettings);var r=new RegExp([(n.escape||B).source,(n.interpolate||B).source,(n.evaluate||B).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(r,function(e,n,i,r,a){return s+=t.slice(o,a).replace(N,function(t){return"\\"+O[t]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(s+="';\n"+r+"\n__p+='"),o=a+e.length,e}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(n.variable||"obj","_",s)}catch(a){throw a.source=s,a}if(e)return i(e,A);var c=function(t){return i.call(this,t,A)};return c.source="function("+(n.variable||"obj")+"){\n"+s+"}",c},A.chain=function(t){return A(t).chain()};var V=function(t){return this._chain?A(t).chain():t};A.mixin(A),T(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];A.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],V.call(this,n)}}),T(["concat","join","slice"],function(t){var e=i[t];A.prototype[t]=function(){return V.call(this,e.apply(this._wrapped,arguments))}}),A.extend(A.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};!function(){var t=[],e=t.slice,n=function(t,e,n){var i,r=-1,o=e.length;switch(n.length){case 0:for(;++r<o;)(i=e[r]).callback.call(i.ctx);return;case 1:for(;++r<o;)(i=e[r]).callback.call(i.ctx,n[0]);return;case 2:for(;++r<o;)(i=e[r]).callback.call(i.ctx,n[0],n[1]);return;case 3:for(;++r<o;)(i=e[r]).callback.call(i.ctx,n[0],n[1],n[2]);return;default:for(;++r<o;)(i=e[r]).callback.apply(i.ctx,n)}},i=Backbone.Events={on:function(t,e,n){this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){var i=this,r=_.once(function(){i.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n),this},off:function(t,e,n){var i,r,o,s,a,c,l,u;if(!this._events)return this;if(!t&&!e&&!n)return this._events={},this;for(s=t?[t]:_.keys(this._events),a=0,c=s.length;c>a;a++)if(t=s[a],i=this._events[t]){if(o=[],e||n)for(l=0,u=i.length;u>l;l++)r=i[l],(e&&e!==(r.callback._callback||r.callback)||n&&n!==r.context)&&o.push(r);this._events[t]=o}return this},trigger:function(t){if(!this._events)return this;var i=e.call(arguments,1),r=this._events[t],o=this._events.all;return r&&n(this,r,i),o&&n(this,o,arguments),this},listenTo:function(t,e,n){var i=this._listeners||(this._listeners={}),r=t._listenerId||(t._listenerId=_.uniqueId("l"));return i[r]=t,t.on(e,n||this,this),this},stopListening:function(t,e,n){var i=this._listeners;if(i){if(t)t.off(e,n,this),e||n||delete i[t._listenerId];else{for(var r in i)i[r].off(null,null,this);this._listeners={}}return this}}};i.bind=i.on,i.unbind=i.off,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=i),exports.Backbone=exports.Backbone||Backbone)}(),function(){function t(t,i){var r=(new Date).getTime(),o=Math.max(0,16-(r-n)),s=e.setTimeout(function(){t(r+o)},o);return n=r+o,s}var e=this,n=0,i=["ms","moz","webkit","o"];if("undefined"!=typeof exports)return"undefined"!=typeof module&&module.exports&&(exports=module.exports=t),void(exports.requestAnimationFrame=t);for(var r=0;r<i.length&&!e.requestAnimationFrame;++r)e.requestAnimationFrame=e[i[r]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[i[r]+"CancelAnimationFrame"]||e[i[r]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=t),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(){function t(){var t=document.body.getBoundingClientRect(),e=this.width=t.width,n=this.height=t.height;this.renderer.setSize(e,n,this.ratio),this.trigger(p.Events.resize,e,n)}function e(){return(n.performance&&n.performance.now?n.performance:Date).now()}var n=this,i=n.Two||{},r=Math.sin,o=Math.cos,s=Math.atan2,a=Math.sqrt,c=(Math.round,Math.abs,Math.PI),l=2*c,u=c/2,h=Math.pow,f=(Math.min,Math.max,0),d={hasEventListeners:_.isFunction(n.addEventListener),bind:function(t,e,n,i){return this.hasEventListeners?t.addEventListener(e,n,!!i):t.attachEvent("on"+e,n),this},unbind:function(t,e,n,i){return this.hasEventListeners?t.removeEventListeners(e,n,!!i):t.detachEvent("on"+e,n),this}},p=n.Two=function(e){var i=_.defaults(e||{},{fullscreen:!1,width:640,height:480,type:p.Types.svg,autostart:!1});if(_.each(i,function(t,e){"fullscreen"!==e&&"width"!==e&&"height"!==e&&"autostart"!==e&&(this[e]=t)},this),_.isElement(i.domElement)&&(this.type=p.Types[i.domElement.tagName.toLowerCase()]),this.renderer=new p[this.type](this),p.Utils.setPlaying.call(this,i.autostart),this.frameCount=0,i.fullscreen){var r=_.bind(t,this);_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),d.bind(n,"resize",r),r()}else _.isElement(i.domElement)||(this.renderer.setSize(i.width,i.height,this.ratio),this.width=i.width,this.height=i.height);this.scene=this.renderer.scene,p.Instances.push(this)};_.extend(p,{Array:n.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){return n.Two=i,this},uniqueId:function(){var t=f;return f++,t},Utils:{release:function(t){_.isObject(t)&&(_.isFunction(t.unbind)&&t.unbind(),t.vertices&&(_.isFunction(t.vertices.unbind)&&t.vertices.unbind(),_.each(t.vertices,function(t){_.isFunction(t.unbind)&&t.unbind()})),t.children&&_.each(t.children,function(t){p.Utils.release(t)}))},Curve:{CollinearityEpsilon:h(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:.01}},devicePixelRatio:n.devicePixelRatio||1,getBackingStoreRatio:function(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1},getRatio:function(t){return p.Utils.devicePixelRatio/b(t)},setPlaying:function(t){return this.playing=!!t,this},getComputedMatrix:function(t,e){for(var e=e&&e.identity()||new p.Matrix,n=t;n&&n._matrix;){var i=n._matrix.elements;e.multiply(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9]),n=n.parent}return e},applySvgAttributes:function(t,e){return _.each(t.attributes,function(t,n){var i=t.nodeName;switch(i){case"transform":break;case"visibility":e.visible=!!t.nodeValue;break;case"stroke-linecap":e.cap=t.nodeValue;break;case"stroke-linejoin":e.join=t.nodeValue;break;case"stroke-miterlimit":e.miter=t.nodeValue;break;case"stroke-width":e.linewidth=parseFloat(t.nodeValue);break;case"stroke-opacity":case"fill-opacity":case"opacity":e.opacity=t.nodeValue;break;case"fill":e.fill=t.nodeValue;break;case"stroke":e.stroke=t.nodeValue}}),e},read:{svg:function(){return p.Utils.read.g.apply(this,arguments)},g:function(t){var e=new p.Group;return this.add(e),_.each(t.childNodes,function(t){var n=t.nodeName;if(n){var i=n.replace(/svg\:/gi,"").toLowerCase();if(i in p.Utils.read){var r=p.Utils.read[i].call(this,t);e.add(r)}}},this),p.Utils.applySvgAttributes(t,e)},polygon:function(t,e){var n=t.getAttribute("points"),i=[];n.replace(/([\d\.?]+),([\d\.?]+)/g,function(t,e,n){i.push(new p.Anchor(parseFloat(e),parseFloat(n)))});var r=new p.Polygon(i,!e).noStroke();return p.Utils.applySvgAttributes(t,r)},polyline:function(t){return p.Utils.read.polygon(t,!0)},path:function(t){var e,n,i,r=t.getAttribute("d"),o=!1,s=!1,a=r.match(/[a-df-z][^a-df-z]*/gi),c=a.length-1,l=_.flatten(_.map(a,function(t,r){var a,l,u,h=t[0],f=h.toLowerCase();i=t.slice(1).trim(),i=i.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(t,e,n){return parseFloat(e)*Math.pow(10,n)}),i=i.split(/[\s,]+|(?=\s?[+\-])/),o=h===f;var d,m,g,v,y,x,b,w,A;switch(f){case"z":r>=c?s=!0:(l=e.x,u=e.y,a=new p.Anchor(l,u,void 0,void 0,void 0,void 0,p.Commands.close));break;case"m":case"l":l=parseFloat(i[0]),u=parseFloat(i[1]),a=new p.Anchor(l,u,void 0,void 0,void 0,void 0,"m"===f?p.Commands.move:p.Commands.line),o&&a.addSelf(e),a.controls.left.copy(a),a.controls.right.copy(a),e=a;break;case"h":case"v":var T="h"===f?"x":"y",E="x"===T?"y":"x";a=new p.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,p.Commands.line),a[T]=parseFloat(i[0]),a[E]=e[E],o&&(a[T]+=e[T]),a.controls.left.copy(a),a.controls.right.copy(a),e=a;break;case"s":case"c":d=e.x,m=e.y,n||(n=(new p.Vector).copy(e)),"c"===f?(g=parseFloat(i[0]),v=parseFloat(i[1]),y=parseFloat(i[2]),x=parseFloat(i[3]),b=parseFloat(i[4]),w=parseFloat(i[5])):(A=p.Utils.getReflection(e,n,o),g=A.x,v=A.y,y=parseFloat(i[0]),x=parseFloat(i[1]),b=parseFloat(i[2]),w=parseFloat(i[3])),o&&(g+=d,v+=m,y+=d,x+=m,b+=d,w+=m),_.isObject(e.controls)||p.Anchor.AppendCurveProperties(e),e.controls.right.set(g,v),a=new p.Anchor(b,w,y,x,void 0,void 0,p.Commands.curve),e=a,n=a.controls.left;break;case"t":case"q":d=e.x,m=e.y,n||(n=(new p.Vector).copy(e)),n.isZero()?(g=d,v=m):(g=n.x,m=n.y),"q"===f?(y=parseFloat(i[0]),x=parseFloat(i[1]),b=parseFloat(i[1]),w=parseFloat(i[2])):(A=p.Utils.getReflection(e,n,o),y=A.x,x=A.y,b=parseFloat(i[0]),w=parseFloat(i[1])),o&&(g+=d,v+=m,y+=d,x+=m,b+=d,w+=m),_.isObject(e.controls)||p.Anchor.AppendCurveProperties(e),e.controls.right.set(g,v),a=new p.Anchor(b,w,y,x,void 0,void 0,p.Commands.curve),e=a,n=a.controls.left;break;case"a":throw new p.Utils.Error("not yet able to interpret Elliptical Arcs.")}return a}));if(!(l.length<=1)){l=_.compact(l);var u=new p.Polygon(l,s,void 0,!0).noStroke();return p.Utils.applySvgAttributes(t,u)}},circle:function(t){var e=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy")),i=parseFloat(t.getAttribute("r")),s=p.Resolution,a=_.map(_.range(s),function(t){var e=t/s,n=e*l,a=i*o(n),c=i*r(n);return new p.Anchor(a,c)},this),c=new p.Polygon(a,!0,!0).noStroke();return c.translation.set(e,n),p.Utils.applySvgAttributes(t,c)},ellipse:function(t){var e=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy")),i=parseFloat(t.getAttribute("rx")),s=parseFloat(t.getAttribute("ry")),a=p.Resolution,c=_.map(_.range(a),function(t){var e=t/a,n=e*l,c=i*o(n),u=s*r(n);return new p.Anchor(c,u)},this),u=new p.Polygon(c,!0,!0).noStroke();return u.translation.set(e,n),p.Utils.applySvgAttributes(t,u)},rect:function(t){var e=parseFloat(t.getAttribute("x")),n=parseFloat(t.getAttribute("y")),i=parseFloat(t.getAttribute("width")),r=parseFloat(t.getAttribute("height")),o=i/2,s=r/2,a=[new p.Anchor(o,s),new p.Anchor(-o,s),new p.Anchor(-o,-s),new p.Anchor(o,-s)],c=new p.Polygon(a,!0).noStroke();return c.translation.set(e+o,n+s),p.Utils.applySvgAttributes(t,c)},line:function(t){var e=parseFloat(t.getAttribute("x1")),n=parseFloat(t.getAttribute("y1")),i=parseFloat(t.getAttribute("x2")),r=parseFloat(t.getAttribute("y2")),o=i-e,s=r-n,a=o/2,c=s/2,l=[new p.Anchor(-a,-c),new p.Anchor(a,c)],u=new p.Polygon(l).noFill();return u.translation.set(e+a,n+c),p.Utils.applySvgAttributes(t,u)}},subdivide:function(t,e,n,i,r,o,s,a,c){var c=c||p.Utils.Curve.RecursionLimit,l=c+1;return _.map(_.range(0,l),function(c){var u=c/l,h=w(u,t,n,r,s),f=w(u,e,i,o,a);return new p.Anchor(h,f)})},getPointOnCubicBezier:function(t,e,n,i,r){var o=1-t;return o*o*o*e+3*o*o*t*n+3*o*t*t*i+t*t*t*r},getCurveFromPoints:function(t,e){for(var n=t.length,i=n-1,r=0;n>r;r++){var o=t[r];_.isObject(o.controls)||p.Anchor.AppendCurveProperties(o);var s=e?x(r-1,n):Math.max(r-1,0),a=e?x(r+1,n):Math.min(r+1,i),c=t[s],l=o,u=t[a];y(c,l,u),l._command=0===r?p.Commands.move:p.Commands.curve,l.controls.left.x=_.isNumber(l.controls.left.x)?l.controls.left.x:l.x,l.controls.left.y=_.isNumber(l.controls.left.y)?l.controls.left.y:l.y,l.controls.right.x=_.isNumber(l.controls.right.x)?l.controls.right.x:l.x,l.controls.right.y=_.isNumber(l.controls.right.y)?l.controls.right.y:l.y}},getControlPoints:function(t,e,n){var i=v(t,e),s=v(n,e),a=m(t,e),l=m(n,e),h=(i+s)/2;return e.u=_.isObject(e.controls.left)?e.controls.left:new p.Vector(e.x,e.y),e.v=_.isObject(e.controls.right)?e.controls.right:new p.Vector(e.x,e.y),1e-4>a||1e-4>l?(e.controls.left.copy(e),e.controls.right.copy(e),e):(a*=.33,l*=.33,i>s?h+=u:h-=u,e.controls.left.x=e.x+o(h)*a,e.controls.left.y=e.y+r(h)*a,h-=c,e.controls.right.x=e.x+o(h)*l,e.controls.right.y=e.y+r(h)*l,e)},getReflection:function(t,e,n){var i=t.distanceTo(e);if(1e-4>=i)return n?new p.Vector:t.clone();var r=v(t,e);return new p.Vector(i*Math.cos(r)+(n?0:t.x),i*Math.sin(r)+(n?0:t.y))},angleBetween:function(t,e){var n,i;return arguments.length>=4?(n=arguments[0]-arguments[2],i=arguments[1]-arguments[3],s(i,n)):(n=t.x-e.x,i=t.y-e.y,s(i,n))},distanceBetweenSquared:function(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i},distanceBetween:function(t,e){return a(g(t,e))},mod:function(t,e){for(;0>t;)t+=e;return t%e},Collection:function(){Array.call(this),arguments.length>1?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(t){this.name="two.js",this.message=t}}}),p.Utils.Error.prototype=new Error,p.Utils.Error.prototype.constructor=p.Utils.Error,p.Utils.Collection.prototype=new Array,p.Utils.Collection.constructor=p.Utils.Collection,_.extend(p.Utils.Collection.prototype,Backbone.Events,{pop:function(){var t=Array.prototype.pop.apply(this,arguments);return this.trigger(p.Events.remove,[t]),t},shift:function(){var t=Array.prototype.shift.apply(this,arguments);return this.trigger(p.Events.remove,[t]),t},push:function(){var t=Array.prototype.push.apply(this,arguments);return this.trigger(p.Events.insert,arguments),t},unshift:function(){var t=Array.prototype.unshift.apply(this,arguments);return this.trigger(p.Events.insert,arguments),t},splice:function(){var t,e=Array.prototype.splice.apply(this,arguments);return this.trigger(p.Events.remove,e),arguments.length>2&&(t=this.slice(arguments[0],arguments.length-2),this.trigger(p.Events.insert,t)),e}});var m=p.Utils.distanceBetween,g=p.Utils.distanceBetweenSquared,v=p.Utils.angleBetween,y=p.Utils.getControlPoints,x=(p.Utils.getCurveFromPoints,p.Utils.solveSegmentIntersection,p.Utils.decoupleShapes,p.Utils.mod),b=p.Utils.getBackingStoreRatio,w=p.Utils.getPointOnCubicBezier;_.extend(p.prototype,Backbone.Events,{appendTo:function(t){return t.appendChild(this.renderer.domElement),this},play:function(){return p.Utils.setPlaying.call(this,!0),this.trigger(p.Events.play)},pause:function(){return this.playing=!1,this.trigger(p.Events.pause)},update:function(){var t=!!this._lastFrame,n=e();this.frameCount++,t&&(this.timeDelta=parseFloat((n-this._lastFrame).toFixed(3))),this._lastFrame=n;var i=this.width,r=this.height,o=this.renderer;return i===o.width&&r===o.height||o.setSize(i,r,this.ratio),this.trigger(p.Events.update,this.frameCount,this.timeDelta),this.render()},render:function(){return this.renderer.render(),this.trigger(p.Events.render,this.frameCount)},add:function(t){var e=t;return _.isArray(t)||(e=_.toArray(arguments)),this.scene.add(e),this},remove:function(t){var e=t;return _.isArray(t)||(e=_.toArray(arguments)),this.scene.remove(e),this},clear:function(){return this.scene.remove(_.toArray(this.scene.children)),this},makeLine:function(t,e,n,i){var r=n-t,o=i-e,s=r/2,a=o/2,c=[new p.Anchor(-s,-a),new p.Anchor(s,a)],l=new p.Polygon(c).noFill();return l.translation.set(t+s,e+a),this.scene.add(l),l},makeRectangle:function(t,e,n,i){var r=n/2,o=i/2,s=[new p.Anchor(r,o),new p.Anchor(-r,o),new p.Anchor(-r,-o),new p.Anchor(r,-o)],a=new p.Polygon(s,!0);return a.translation.set(t,e),this.scene.add(a),a},makeCircle:function(t,e,n){return this.makeEllipse(t,e,n,n)},makeEllipse:function(t,e,n,i){var s=p.Resolution,a=_.map(_.range(s),function(t){var e=t/s,a=e*l,c=n*o(a),u=i*r(a);return new p.Anchor(c,u)},this),c=new p.Polygon(a,!0,!0);return c.translation.set(t,e),this.scene.add(c),c},makeCurve:function(t){var e=arguments.length,n=t;if(!_.isArray(t)){n=[];for(var i=0;e>i;i+=2){var r=arguments[i];if(!_.isNumber(r))break;var o=arguments[i+1];n.push(new p.Anchor(r,o))}}var s=arguments[e-1],a=new p.Polygon(n,!(_.isBoolean(s)?s:void 0),!0),c=a.getBoundingClientRect(),l=c.left+c.width/2,u=c.top+c.height/2;return _.each(a.vertices,function(t){t.x-=l,t.y-=u}),a.translation.set(l,u),this.scene.add(a),a},makePolygon:function(t){var e=arguments.length,n=t;if(!_.isArray(t)){n=[];for(var i=0;e>i;i+=2){var r=arguments[i];if(!_.isNumber(r))break;var o=arguments[i+1];n.push(new p.Anchor(r,o))}}var s=arguments[e-1],a=new p.Polygon(n,!(_.isBoolean(s)?s:void 0)),c=a.getBoundingClientRect();return a.center().translation.set(c.left+c.width/2,c.top+c.height/2),this.scene.add(a),a},makeGroup:function(t){var e=t;_.isArray(t)||(e=_.toArray(arguments));var n=new p.Group;return this.scene.add(n),n.add(e),n},interpret:function(t){var e=t.tagName.toLowerCase();if(!(e in p.Utils.read))return null;var n=p.Utils.read[e].call(this,t);return this.add(n),n}}),function(){requestAnimationFrame(arguments.callee),_.each(p.Instances,function(t){t.playing&&t.update()})}(),"function"==typeof define&&define.amd?define(function(){return p}):"undefined"!=typeof module&&module.exports&&(module.exports=p)}(),function(){var t,e,n,i,r=Two.Vector=function(t,e){this.x=t||0,this.y=e||0};_.extend(r.prototype,Backbone.Events,{set:function(t,e){return this.x=t,this.y=e,this},copy:function(t){return this.x=t.x,this.y=t.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new r(this.x,this.y)},add:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this},multiplySelf:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return t?(this.x/=t,this.y/=t):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){return n=this.x-t.x,i=this.y-t.y,n*n+i*i},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t){return this.distanceTo(t)<1e-4},lerp:function(n,i){return t=(n.x-this.x)*i+this.x,e=(n.y-this.y)*i+this.y,this.set(t,e)},isZero:function(){return this.length()<1e-4},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var o={set:function(t,e){return this._x=t,this._y=e,this.trigger(Two.Events.change)},copy:function(t){return this._x=t.x,this._y=t.y,this.trigger(Two.Events.change)},clear:function(){return this._x=0,this._y=0,this.trigger(Two.Events.change)},clone:function(){return new r(this._x,this._y)},add:function(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this.trigger(Two.Events.change)},addSelf:function(t){return this._x+=t.x,this._y+=t.y,
this.trigger(Two.Events.change)},sub:function(t,e){return this._x=t.x-e.x,this._y=t.y-e.y,this.trigger(Two.Events.change)},subSelf:function(t){return this._x-=t.x,this._y-=t.y,this.trigger(Two.Events.change)},multiplySelf:function(t){return this._x*=t.x,this._y*=t.y,this.trigger(Two.Events.change)},multiplyScalar:function(t){return this._x*=t,this._y*=t,this.trigger(Two.Events.change)},divideScalar:function(t){return t?(this._x/=t,this._y/=t,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this._x*t.x+this._y*t.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){return n=this._x-t.x,i=this._y-t.y,n*n+i*i},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t){return this.distanceTo(t)<1e-4},lerp:function(n,i){return t=(n.x-this._x)*i+this._x,e=(n.y-this._y)*i+this._y,this.set(t,e)},isZero:function(){return this.length()<1e-4},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},s={get:function(){return this._x},set:function(t){this._x=t,this.trigger(Two.Events.change,"x")}},a={get:function(){return this._y},set:function(t){this._y=t,this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){return this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",s),Object.defineProperty(this,"y",a),_.extend(this,o),this._bound=!0),Backbone.Events.bind.apply(this,arguments),this}}(),function(){var t,e,n,i=Two.Commands,r=Two.Anchor=function(t,e,n,o,s,a,c){return Two.Vector.call(this,t,e),this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this),Object.defineProperty(this,"command",{get:function(){return this._command},set:function(t){return this._command=t,this._command!==i.curve||_.isObject(this.controls)||r.AppendCurveProperties(this),this.trigger(Two.Events.change)}}),this._command=c||i.move,c?(r.AppendCurveProperties(this),_.isNumber(n)&&(this.controls.left.x=n),_.isNumber(o)&&(this.controls.left.y=o),_.isNumber(s)&&(this.controls.right.x=s),void(_.isNumber(a)&&(this.controls.right.y=a))):this};_.extend(r,{AppendCurveProperties:function(n){t=n._x||n.x,e=n._y||n.y,n.controls={left:new Two.Vector(t,e),right:new Two.Vector(t,e)}}});var o={listen:function(){return _.isObject(this.controls)||r.AppendCurveProperties(this),_.each(this.controls,function(t){t.bind(Two.Events.change,this._broadcast)},this),this},ignore:function(){return _.each(this.controls,function(t){t.unbind(Two.Events.change,this._broadcast)},this),this},clone:function(){return n=this.controls,new Two.Anchor(this.x,this.y,n&&n.left.x,n&&n.left.y,n&&n.right.x,n&&n.right.y,this.command)},toObject:function(){var t={x:this.x,y:this.y};return this.command&&(t.command=this.command),this.controls&&(t.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()}),t}};_.extend(r.prototype,Two.Vector.prototype,o),Two.Anchor.prototype.bind=Two.Anchor.prototype.on=function(){Two.Vector.prototype.bind.apply(this,arguments),_.extend(this,o)}}(),function(){var t,e,n,i,r,o,s,a,c,l,u,h,f,d,p,m,g,v,y,x,b,w,A,T,E,F,C,S,k,R,M,P,U,j,B,O,n,N,V,L,I,q,D,z,G,X,Y,W,H,J,Z=(_.range(6),Math.cos),K=Math.sin,$=Math.tan,Q=[],tt=Two.Matrix=function(t,e,n,i,r,o){this.elements=new Two.Array(9);var s=t;_.isArray(s)||(s=_.toArray(arguments)),this.identity().set(s)};_.extend(tt,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(i,o,s){return o.length<=3?(t=o[0]||0,e=o[1]||0,n=o[2]||0,r=i,h=r[0]*t+r[1]*e+r[2]*n,f=r[3]*t+r[4]*e+r[5]*n,d=r[6]*t+r[7]*e+r[8]*n,{x:h,y:f,z:d}):(p=i[0],m=i[1],g=i[2],v=i[3],y=i[4],x=i[5],b=i[6],w=i[7],A=i[8],T=o[0],E=o[1],F=o[2],C=o[3],S=o[4],k=o[5],R=o[6],M=o[7],P=o[8],s=s||new Two.Array(9),s[0]=p*T+m*C+g*R,s[1]=p*E+m*S+g*M,s[2]=p*F+m*k+g*P,s[3]=v*T+y*C+x*R,s[4]=v*E+y*S+x*M,s[5]=v*F+y*k+x*P,s[6]=b*T+w*C+A*R,s[7]=b*E+w*S+A*M,s[8]=b*F+w*k+A*P,s)}}),_.extend(tt.prototype,Backbone.Events,{set:function(t,e,n,i,r,o){return u=t,B=arguments.length,_.isArray(u)||(u=_.toArray(arguments)),_.each(u,function(t,e){_.isNumber(t)&&(this.elements[e]=t)},this),this.trigger(Two.Events.change)},identity:function(){return this.set(tt.Identity),this},multiply:function(t,e,n,i,r,o,s,a,c){return u=arguments,B=u.length,1>=B?(_.each(this.elements,function(e,n){this.elements[n]=e*t},this),this.trigger(Two.Events.change)):3>=B?(t=t||0,e=e||0,n=n||0,r=this.elements,h=r[0]*t+r[1]*e+r[2]*n,f=r[3]*t+r[4]*e+r[5]*n,d=r[6]*t+r[7]*e+r[8]*n,{x:h,y:f,z:d}):(U=this.elements,j=u,p=U[0],m=U[1],g=U[2],v=U[3],y=U[4],x=U[5],b=U[6],w=U[7],A=U[8],T=j[0],E=j[1],F=j[2],C=j[3],S=j[4],k=j[5],R=j[6],M=j[7],P=j[8],this.elements[0]=p*T+m*C+g*R,this.elements[1]=p*E+m*S+g*M,this.elements[2]=p*F+m*k+g*P,this.elements[3]=v*T+y*C+x*R,this.elements[4]=v*E+y*S+x*M,this.elements[5]=v*F+y*k+x*P,this.elements[6]=b*T+w*C+A*R,this.elements[7]=b*E+w*S+A*M,this.elements[8]=b*F+w*k+A*P,this.trigger(Two.Events.change))},inverse:function(e){return t=this.elements,e=e||new Two.Matrix,N=t[0],V=t[1],L=t[2],I=t[3],q=t[4],D=t[5],z=t[6],G=t[7],X=t[8],Y=X*q-D*G,W=-X*I+D*z,H=G*I-q*z,(J=N*Y+V*W+L*H)?(J=1/J,e.elements[0]=Y*J,e.elements[1]=(-X*V+L*G)*J,e.elements[2]=(D*V-L*q)*J,e.elements[3]=W*J,e.elements[4]=(X*N-L*z)*J,e.elements[5]=(-D*N+L*I)*J,e.elements[6]=H*J,e.elements[7]=(-G*N+V*z)*J,e.elements[8]=(q*N-V*I)*J,e):null},scale:function(t,e){return B=arguments.length,1>=B&&(e=t),this.multiply(t,0,0,0,e,0,0,0,1)},rotate:function(t){return n=Z(t),O=K(t),this.multiply(n,-O,0,O,n,0,0,0,1)},translate:function(t,e){return this.multiply(1,0,t,0,1,e,0,0,1)},skewX:function(e){return t=$(e),this.multiply(1,t,0,0,1,0,0,0,1)},skewY:function(e){return t=$(e),this.multiply(1,0,0,t,1,0,0,0,1)},toString:function(t){return this.toArray(t,Q),Q.join(" ")},toArray:function(h,f){return u=this.elements,l=!!f,t=parseFloat(u[0].toFixed(3)),e=parseFloat(u[1].toFixed(3)),n=parseFloat(u[2].toFixed(3)),i=parseFloat(u[3].toFixed(3)),r=parseFloat(u[4].toFixed(3)),o=parseFloat(u[5].toFixed(3)),h?(s=parseFloat(u[6].toFixed(3)),a=parseFloat(u[7].toFixed(3)),c=parseFloat(u[8].toFixed(3)),l?(f[0]=t,f[1]=i,f[2]=s,f[3]=e,f[4]=r,f[5]=a,f[6]=n,f[7]=o,void(f[8]=c)):[t,i,s,e,r,a,n,o,c]):l?(f[0]=t,f[1]=i,f[2]=e,f[3]=r,f[4]=n,void(f[5]=o)):[t,i,e,r,n,o]},clone:function(){return t=this.elements[0],e=this.elements[1],n=this.elements[2],i=this.elements[3],r=this.elements[4],o=this.elements[5],s=this.elements[6],a=this.elements[7],c=this.elements[8],new Two.Matrix(t,e,n,i,r,o,s,a,c)}})}(),function(){var t,e,n,i=Two.Utils.mod,r={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(t,i){return n=t,e=document.createElementNS(this.ns,n),"svg"===n&&(i=_.defaults(i||{},{version:this.version})),_.isObject(i)&&r.setAttributes(e,i),e},setAttribute:function(t,e){this.setAttribute(e,t)},setAttributes:function(t,e){return _.each(e,r.setAttribute,t),this},removeAttribute:function(t,e){this.removeAttribute(e)},removeAttributes:function(t,e){return _.each(e,r.removeAttribute,t),this},toString:function(t,e){var n=t.length,r=n-1;return _.map(t,function(o,s){var a,c,l,u,h,f,d,p,m,g=e?i(s-1,n):Math.max(s-1,0),_=e?i(s+1,n):Math.min(s+1,r),v=t[g],y=t[_],x=o.x.toFixed(3),b=o.y.toFixed(3);switch(o._command){case Two.Commands.close:a=Two.Commands.close;break;case Two.Commands.curve:var f=v.controls&&v.controls.right||v,d=o.controls&&o.controls.left||o;c=f.x.toFixed(3),l=f.y.toFixed(3),u=d.x.toFixed(3),h=d.y.toFixed(3),a=(0===s?Two.Commands.move:Two.Commands.curve)+" "+c+" "+l+" "+u+" "+h+" "+x+" "+b;break;default:a=(0===s?Two.Commands.move:o._command)+" "+x+" "+b}return s>=r&&e&&(o._command===Two.Commands.curve&&(p=o.controls&&o.controls.right||o,m=y.controls&&y.controls.left||y,c=p.x.toFixed(3),l=p.y.toFixed(3),u=m.x.toFixed(3),h=m.y.toFixed(3),x=y.x.toFixed(3),b=y.y.toFixed(3),a+=" C "+c+" "+l+" "+u+" "+h+" "+x+" "+b),a+=" Z"),a}).join(" ")},group:{appendChild:function(t){e=this.domElement.querySelector("#"+Two.Identifier+t),e&&this.elem.appendChild(e)},removeChild:function(t){e=this.domElement.querySelector("#"+Two.Identifier+t),e&&this.elem.removeChild(e)},renderChild:function(t){r[t._renderer.type].render.call(t,this)},render:function(e){this._update(),this._renderer.elem||(this._renderer.elem=r.createElement("g",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem)),t=this._matrix.manual||this._flagMatrix;var n={domElement:e,elem:this._renderer.elem};return t&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")"),_.each(this.children,r.group.renderChild,e),this._flagAdditions&&_.each(this.additions,r.group.appendChild,n),this._flagSubtractions&&_.each(this.subtractions,r.group.removeChild,n),this.flagReset()}},polygon:{render:function(n){return this._update(),this._renderer.elem||(this._renderer.elem=r.createElement("path",{id:Two.Identifier+this.id}),n.appendChild(this._renderer.elem)),e=this._renderer.elem,t=this._matrix.manual||this._flagMatrix,t&&e.setAttribute("transform","matrix("+this._matrix.toString()+")"),this._flagVertices&&(vertices=r.toString(this._vertices,this._closed),e.setAttribute("d",vertices)),this._flagFill&&e.setAttribute("fill",this._fill),this._flagStroke&&e.setAttribute("stroke",this._stroke),this._flagLinewidth&&e.setAttribute("stroke-width",this._linewidth),this._flagOpacity&&(e.setAttribute("stroke-opacity",this._opacity),e.setAttribute("fill-opacity",this._opacity)),this._flagVisible&&e.setAttribute("visibility",this._visible?"visible":"hidden"),this._flagCap&&e.setAttribute("stroke-linecap",this._cap),this._flagJoin&&e.setAttribute("stroke-linejoin",this._join),this._flagMiter&&e.setAttribute("stroke-miterlimit",this.miter),this.flagReset()}}},o=Two[Two.Types.svg]=function(t){this.domElement=t.domElement||r.createElement("svg"),this.scene=new Two.Group,this.scene.parent=this};_.extend(o,{Utils:r}),_.extend(o.prototype,Backbone.Events,{setSize:function(t,e){return this.width=t,this.height=e,r.setAttributes(this.domElement,{width:t,height:e}),this},render:function(){return r.group.render.call(this.scene,this.domElement),this}})}(),function(){var t,e,n,i,r,o,s,a,c,l,u,h,f,d,p,m,g,v,y,x,b,w,A,T,E,F,C,S=Two.Utils.mod,k=Two.Utils.getRatio,R={group:{renderChild:function(t){R[t._renderer.type].render.call(t,this)},render:function(e){return this._update(),t=this._matrix.elements,e.save(),e.transform(t[0],t[3],t[1],t[4],t[2],t[5]),_.each(this.children,R.group.renderChild,e),e.restore(),this.flagReset()}},polygon:{render:function(k){return this._update(),t=this._matrix.elements,e=this.stroke,n=this.linewidth,i=this.fill,r=this.opacity,o=this.visible,s=this.cap,a=this.join,c=this.miter,l=this.closed,u=this._vertices,h=u.length,f=h-1,o?(k.save(),t&&k.transform(t[0],t[3],t[1],t[4],t[2],t[5]),i&&(k.fillStyle=i),e&&(k.strokeStyle=e),n&&(k.lineWidth=n),c&&(k.miterLimit=c),a&&(k.lineJoin=a),s&&(k.lineCap=s),_.isNumber(r)&&(k.globalAlpha=r),k.beginPath(),_.each(u,function(t,e){switch(F=t.x.toFixed(3),C=t.y.toFixed(3),t._command){case Two.Commands.close:k.closePath();break;case Two.Commands.curve:p=l?S(e-1,h):Math.max(e-1,0),d=l?S(e+1,h):Math.min(e+1,f),m=u[p],g=u[d],w=m.controls&&m.controls.right||m,A=t.controls&&t.controls.left||t,x=w.x.toFixed(3),b=w.y.toFixed(3),v=A.x.toFixed(3),y=A.y.toFixed(3),k.bezierCurveTo(x,b,v,y,F,C),e>=f&&l&&(T=t.controls&&t.controls.right||t,E=g.controls&&g.controls.left||g,x=T.x.toFixed(3),b=T.y.toFixed(3),v=E.x.toFixed(3),y=E.y.toFixed(3),F=g.x.toFixed(3),C=g.y.toFixed(3),k.bezierCurveTo(x,b,v,y,F,C));break;case Two.Commands.line:k.lineTo(F,C);break;case Two.Commands.move:k.moveTo(F,C)}}),l&&k.closePath(),k.fill(),k.stroke(),k.restore(),this.flagReset()):this}}},M=Two[Two.Types.canvas]=function(t){this.domElement=t.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=!1,this.scene=new Two.Group,this.scene.parent=this};_.extend(M,{Utils:R}),_.extend(M.prototype,Backbone.Events,{setSize:function(t,e,n){return this.width=t,this.height=e,this.ratio=_.isUndefined(n)?k(this.ctx):n,this.domElement.width=t*this.ratio,this.domElement.height=e*this.ratio,_.extend(this.domElement.style,{width:t+"px",height:e+"px"}),this},render:function(){var t=1===this.ratio;return t||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),R.group.render.call(this.scene,this.ctx),t||this.ctx.restore(),this}})}(),function(){var t,e,n,i,r,o,s,a,c,l,u,h,f,d,p,m,g,v,y,x,b,w,A,T,E,F,C,S,k,R,M,P,U,j,B,O,N,V,L,I,q,D,z,G,X,Y,W,H,J,Z,K,$,Q,tt,et,nt=(Two[Two.Types.canvas],Two.Matrix.Multiply),it=Two.Utils.mod,rt=[1,0,0,0,1,0,0,0,1],ot=new Two.Array(9),st=Two.Utils.getRatio,at={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(t){at[t._renderer.type].render.call(t,this.gl,this.program)},render:function(i,r){return this._update(),t=this.parent,e=t._matrix&&t._matrix.manual||t._flagMatrix,n=this._matrix.manual||this._flagMatrix,(e||n)&&(this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,ot),nt(ot,t._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*t._renderer.scale,e&&(this._flagMatrix=!0)),_.each(this.children,at.group.renderChild,{gl:i,program:r}),this.flagReset()}},polygon:{render:function(r,o){return this._visible&&this._opacity?(t=this.parent,e=t._matrix.manual||t._flagMatrix,n=this._matrix.manual||this._flagMatrix,i=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale,this._update(),(e||n)&&(this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,ot),nt(ot,t._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*t._renderer.scale),i&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),at.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),at.getTriangles(this._renderer.rect,this._renderer.triangles),at.updateBuffer(r,this,o),at.updateTexture(r,this)),r.bindBuffer(r.ARRAY_BUFFER,this._renderer.textureCoordsBuffer),r.vertexAttribPointer(o.textureCoords,2,r.FLOAT,!1,0,0),r.bindTexture(r.TEXTURE_2D,this._renderer.texture),r.uniformMatrix3fv(o.matrix,!1,this._renderer.matrix),r.bindBuffer(r.ARRAY_BUFFER,this._renderer.buffer),r.vertexAttribPointer(o.position,2,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLES,0,6),this.flagReset()):this}},getBoundingClientRect:function(t,e,n){r=1/0,o=-(1/0),s=1/0,a=-(1/0),_.each(t,function(t,e){c=t.x,l=t.y,p=t.controls,s=Math.min(l,s),r=Math.min(c,r),o=Math.max(c,o),a=Math.max(l,a),t.controls&&(m=p.left,g=p.right,m&&g&&(u=m.x,h=m.y,f=g.x,d=g.y,u&&h&&f&&d&&(s=Math.min(h,d,s),r=Math.min(u,f,r),o=Math.max(u,f,o),a=Math.max(h,d,a))))}),_.isNumber(e)&&(s-=e,r-=e,o+=e,a+=e),v=o-r,y=a-s,n.top=s,n.left=r,n.right=o,n.bottom=a,n.width=v,n.height=y,n.centroid||(n.centroid={}),n.centroid.x=-r,n.centroid.y=-s},getTriangles:function(t,e){s=t.top,r=t.left,o=t.right,a=t.bottom,e[0]=r,e[1]=s,e[2]=o,e[3]=s,e[4]=r,e[5]=a,e[6]=r,e[7]=a,e[8]=o,e[9]=s,e[10]=o,e[11]=a},updateCanvas:function(t){x=t._vertices,b=this.canvas,w=this.ctx,A=t._renderer.scale,T=t._stroke,E=t._linewidth*A,F=t._fill,C=t._opacity,S=t._cap,k=t._join,R=t._miter,M=t._closed,P=x.length,U=P-1,b.width=Math.max(Math.ceil(t._renderer.rect.width*A),1),b.height=Math.max(Math.ceil(t._renderer.rect.height*A),1),j=t._renderer.rect.centroid,B=j.x*A,O=j.y*A,w.clearRect(0,0,b.width,b.height),F&&(w.fillStyle=F),T&&(w.strokeStyle=T),E&&(w.lineWidth=E),R&&(w.miterLimit=R),k&&(w.lineJoin=k),S&&(w.lineCap=S),_.isNumber(C)&&(w.globalAlpha=C),w.beginPath(),_.each(x,function(t,e){switch(c=(t.x*A+B).toFixed(3),l=(t.y*A+O).toFixed(3),t._command){case Two.Commands.close:w.closePath();break;case Two.Commands.curve:V=M?it(e-1,P):Math.max(e-1,0),N=M?it(e+1,P):Math.min(e+1,U),u=x[V],f=x[N],z=u.controls&&u.controls.right||u,G=t.controls&&t.controls.left||t,q=(z.x*A+B).toFixed(3),D=(z.y*A+O).toFixed(3),L=(G.x*A+B).toFixed(3),I=(G.y*A+O).toFixed(3),w.bezierCurveTo(q,D,L,I,c,l),e>=U&&M&&(X=t.controls&&t.controls.right||t,m=f.controls&&f.controls.left||f,q=(X.x*A+B).toFixed(3),D=(X.y*A+O).toFixed(3),L=(m.x*A+B).toFixed(3),I=(m.y*A+O).toFixed(3),c=(f.x*A+B).toFixed(3),l=(f.y*A+O).toFixed(3),w.bezierCurveTo(q,D,L,I,c,l));break;case Two.Commands.line:w.lineTo(c,l);break;case Two.Commands.move:w.moveTo(c,l)}}),M&&w.closePath(),w.fill(),w.stroke()},updateTexture:function(t,e){this.updateCanvas(e),e._renderer.texture&&t.deleteTexture(e._renderer.texture),t.bindBuffer(t.ARRAY_BUFFER,e._renderer.textureCoordsBuffer),e._renderer.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,e._renderer.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),this.canvas.width<=0||this.canvas.height<=0||t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(t,e,n){_.isObject(e._renderer.buffer)&&t.deleteBuffer(e._renderer.buffer),e._renderer.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e._renderer.buffer),t.enableVertexAttribArray(n.position),t.bufferData(t.ARRAY_BUFFER,e._renderer.triangles,t.STATIC_DRAW),_.isObject(e._renderer.textureCoordsBuffer)&&t.deleteBuffer(e._renderer.textureCoordsBuffer),e._renderer.textureCoordsBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e._renderer.textureCoordsBuffer),t.enableVertexAttribArray(n.textureCoords),t.bufferData(t.ARRAY_BUFFER,this.uv,t.STATIC_DRAW)},program:{create:function(t,e){if(Y=t.createProgram(),_.each(e,function(e){t.attachShader(Y,e)}),t.linkProgram(Y),W=t.getProgramParameter(Y,t.LINK_STATUS),!W)throw Z=t.getProgramInfoLog(Y),t.deleteProgram(Y),new Two.Utils.Error("unable to link program: "+Z);return Y}},shaders:{create:function(t,e,n){if(H=t.createShader(t[n]),t.shaderSource(H,e),t.compileShader(H),J=t.getShaderParameter(H,t.COMPILE_STATUS),!J)throw Z=t.getShaderInfoLog(H),t.deleteShader(H),new Two.Utils.Error("unable to compile shader "+H+": "+Z);return H},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};at.ctx=at.canvas.getContext("2d");var ct=Two[Two.Types.webgl]=function(t){if(this.domElement=t.domElement||document.createElement("canvas"),this.scene=new Two.Group,this.scene.parent=this,this._renderer={matrix:new Two.Array(rt),scale:1},this._flagMatrix=!0,et=_.defaults(t||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=et.overdraw,K=this.ctx=this.domElement.getContext("webgl",et)||this.domElement.getContext("experimental-webgl",et),!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");tt=at.shaders.create(K,at.shaders.vertex,at.shaders.types.vertex),Q=at.shaders.create(K,at.shaders.fragment,at.shaders.types.fragment),this.program=at.program.create(K,[tt,Q]),K.useProgram(this.program),this.program.position=K.getAttribLocation(this.program,"a_position"),this.program.matrix=K.getUniformLocation(this.program,"u_matrix"),this.program.textureCoords=K.getAttribLocation(this.program,"a_textureCoords"),K.disable(K.DEPTH_TEST),K.enable(K.BLEND),K.blendEquationSeparate(K.FUNC_ADD,K.FUNC_ADD),K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA)};_.extend(ct.prototype,Backbone.Events,{setSize:function(t,e,n){return this.width=t,this.height=e,this.ratio=_.isUndefined(n)?st(this.ctx):n,this.domElement.width=t*this.ratio,this.domElement.height=e*this.ratio,_.extend(this.domElement.style,{width:t+"px",height:e+"px"}),t*=this.ratio,e*=this.ratio,this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,this.ctx.viewport(0,0,t,e),$=this.ctx.getUniformLocation(this.program,"u_resolution"),this.ctx.uniform2f($,t,e),this},render:function(){return K=this.ctx,this.overdraw||K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT),at.group.render.call(this.scene,K,this.program),this._flagMatrix=!1,this}})}(),function(){var t,e=(new Two.Vector,Two.Shape=function(t){this._renderer={},this.id=Two.uniqueId(),this._matrix=new Two.Matrix,this.translation=new Two.Vector,this.translation.bind(Two.Events.change,_.bind(e.FlagMatrix,this)),this.rotation=0,this.scale=1});_.extend(e,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(t){Object.defineProperty(t,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._flagMatrix=!0}}),Object.defineProperty(t,"scale",{get:function(){return this._scale},set:function(t){this._scale=t,this._flagMatrix=!0,this._flagScale=!0}})}}),_.extend(e.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(t){return t.add(this),this},clone:function(){return t=new e,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,_.each(e.Properties,function(e){t[e]=this[e]},this),t._update()},_update:function(){return!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation),this},flagReset:function(){return this._flagMatrix=!1,this._flagScale=!1,this}}),e.MakeObservable(e.prototype)}(),function(){var t,e,n,i,r,o,s,a,c,l,u,h,f,d,p,m,g,v,y,x,b,w,A,T,E,F,C,S,k,R,M,P=Math.min,U=Math.max,j=Math.round,B=Two.Utils.getComputedMatrix,O=Two.Polygon=function(t,e,n,i){Two.Shape.call(this),this._renderer.type="polygon",this._closed=!!e,this._curved=!!n,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this._vertices=[],this.vertices=t,this.automatic=!i};_.extend(O,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"],FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(t){Two.Shape.MakeObservable(t),_.each(O.Properties.slice(0,8),function(e){var n="_"+e,i="_flag"+e.charAt(0).toUpperCase()+e.slice(1);Object.defineProperty(t,e,{get:function(){return this[n]},set:function(t){this[n]=t,this[i]=!0}})}),Object.defineProperty(t,"closed",{get:function(){return this._closed},set:function(t){this._closed=!!t,this._flagVertices=!0}}),Object.defineProperty(t,"curved",{get:function(){return this._curved},set:function(t){this._curved=!!t,this._flagVertices=!0}}),Object.defineProperty(O.prototype,"automatic",{get:function(){return this._automatic},set:function(t){t!==this._automatic&&(this._automatic=!!t,method=this._automatic?"ignore":"listen",_.each(this.vertices,function(t){t[method]()}))}}),Object.defineProperty(t,"beginning",{get:function(){return this._beginning},set:function(t){this._beginning=P(U(t,0),1),this._flagVertices=!0}}),Object.defineProperty(t,"ending",{get:function(){return this._ending},set:function(t){this._ending=P(U(t,0),1),this._flagVertices=!0}}),Object.defineProperty(t,"vertices",{get:function(){return this._collection},set:function(t){var e=_.bind(O.FlagVertices,this),n=_.bind(function(t){_.each(t,function(t){t.bind(Two.Events.change,e)},this),e()},this),i=_.bind(function(t){_.each(t,function(t){t.unbind(Two.Events.change,e)},this),e()},this);this._collection&&this._collection.unbind(),this._collection=new Two.Utils.Collection(t.slice(0)),this._collection.bind(Two.Events.insert,n),this._collection.bind(Two.Events.remove,i),verticesChanged=!0,n(this._collection)}})}}),_.extend(O.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(t){return t=t||this.parent,a=_.map(this.vertices,function(t){return t.clone()}),c=new O(a,this.closed,this.curved,!this.automatic),_.each(Two.Shape.Properties,function(t){c[t]=this[t]},this),c.translation.copy(this.translation),c.rotation=this.rotation,c.scale=this.scale,t.add(c),c},toObject:function(){var t={vertices:_.map(this.vertices,function(t){return t.toObject()})};return _.each(Two.Shape.Properties,function(e){t[e]=this[e]},this),t.translation=this.translation.toObject,t.rotation=this.rotation,t.scale=this.scale,t},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke="transparent",this},corner:function(){return l=this.getBoundingClientRect(!0),l.centroid={x:l.left+l.width/2,y:l.top+l.height/2},_.each(this.vertices,function(t){t.addSelf(l.centroid)}),this},center:function(){return l=this.getBoundingClientRect(!0),l.centroid={x:l.left+l.width/2,y:l.top+l.height/2},_.each(this.vertices,function(t){t.subSelf(l.centroid)}),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(t){return this._update(),u=this.linewidth/2,h,f=1/0,d=-(1/0),p=1/0,m=-(1/0),_.each(this._vertices,function(t){g=t.x,v=t.y,p=P(v,p),f=P(g,f),d=U(g,d),m=U(v,m)}),p-=u,f-=u,d+=u,m+=u,A=t?this._matrix:B(this),y=A.multiply(f,p,1),x=A.multiply(d,p,1),b=A.multiply(d,m,1),w=A.multiply(f,m,1),p=P(y.y,x.y,b.y,w.y),f=P(y.x,x.x,b.x,w.x),d=U(y.x,x.x,b.x,w.x),m=U(y.y,x.y,b.y,w.y),{top:p,left:f,right:d,bottom:m,width:d-f,height:m-p}},plot:function(){return this.curved?(Two.Utils.getCurveFromPoints(this.vertices,this.closed),this):(_.each(this.vertices,function(t,e){t._command=0===e?Two.Commands.move:Two.Commands.line},this),this)},subdivide:function(t){return this._update(),i=this.vertices.length-1,x=this.vertices[i],r=this._closed||this.vertices[i].command===Two.Commands.close,a=[],_.each(this.vertices,function(e,n){if(0>=n&&!r||e.command===Two.Commands.move)return a.push(new Two.Anchor(x.x,x.y)),a[a.length-1].command=Two.Commands.line,void(x=e);d=x.controls&&x.controls.right,f=e.controls&&e.controls.left,T=x.x,E=x.y,F=(d||x).x,C=(d||x).y,S=(f||e).x,k=(f||e).y,R=e.x,M=e.y;var o=Two.Utils.subdivide(T,E,F,C,S,k,R,M,t);a=a.concat(o),_.each(o,function(t,e){0>=e&&x.command===Two.Commands.move?t.command=Two.Commands.move:t.command=Two.Commands.line}),n>=i&&(a.push(new Two.Anchor(R,M)),a[a.length-1].command=r?Two.Commands.close:Two.Commands.line),x=e},this),this._automatic=!1,this._curved=!1,this.vertices=a,this},_update:function(){if(this._flagVertices)for(this._automatic&&this.plot(),t=this.vertices.length,i=t-1,e=j(this._beginning*i),n=j(this._ending*i),this._vertices.length=0,s=e;n+1>s;s++)o=this.vertices[s],this._vertices.push(o);return Two.Shape.prototype._update.call(this),this},flagReset:function(){return this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1,Two.Shape.prototype.flagReset.call(this),this}}),O.MakeObservable(O.prototype)}(),function(){var t,e,n,i,r,o,s,a,c,l,u,h,f,d,p,m,g,v,y,x,b,w=Math.min,A=Math.max,T=Two.Group=function(t){Two.Shape.call(this,!0),this._renderer.type="group",this.additions=[],this.subtractions=[],this.children={}};_.extend(T,{MakeObservable:function(t){Two.Shape.MakeObservable(t),T.MakeGetterSetter(t,Two.Polygon.Properties)},MakeGetterSetter:function(e,n){_.isArray(n)||(n=[n]),_.each(n,function(n){t="_"+n,Object.defineProperty(e,n,{get:function(){return this[t]},set:function(e){this[t]=e,_.each(this.children,function(t){t[n]=e})}})})}}),_.extend(T.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(t){return t=t||this.parent,i=new T,t.add(i),n=_.map(this.children,function(t){return t.clone(i)}),i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i},toObject:function(){var t={children:{},translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};return _.each(this.children,function(e,n){t.children[n]=e.toObject()},this),t},corner:function(){return r=this.getBoundingClientRect(!0),o={x:r.left,y:r.top},_.each(this.children,function(t){t.translation.subSelf(o)}),this},center:function(){return r=this.getBoundingClientRect(!0),r.centroid={x:r.left+r.width/2,y:r.top+r.height/2},_.each(this.children,function(t){t.translation.subSelf(r.centroid)}),this},add:function(t){return s=arguments.length,a=t,n=this.children,c=this.parent,l=this.additions,_.isArray(t)||(a=_.toArray(arguments)),_.each(a,function(t){t&&(u=t.id,e=t.parent,_.isUndefined(n[u])&&(e&&(delete e.children[u],b=_.indexOf(e.additions,u),b>=0&&e.additions.splice(b,1)),n[u]=t,t.parent=this,l.push(u),this._flagAdditions=!0))},this),this},remove:function(t){return s=arguments.length,a=t,n=this.children,c=this.parent,l=this.subtractions,0>=s&&c?(c.remove(this),this):(_.isArray(t)||(a=_.toArray(arguments)),_.each(a,function(t){u=t.id,grandchildren=t.children,e=t.parent,u in n&&(delete n[u],delete t.parent,b=_.indexOf(e.additions,u),b>=0&&e.additions.splice(b,1),l.push(u),this._flagSubtractions=!0)},this),this)},getBoundingClientRect:function(t){return this._update(),h=1/0,f=-(1/0),d=1/0,p=-(1/0),_.each(this.children,function(t){r=t.getBoundingClientRect(!0),_.isNumber(r.top)&&_.isNumber(r.left)&&_.isNumber(r.right)&&_.isNumber(r.bottom)&&(d=w(r.top,d),h=w(r.left,h),f=A(r.right,f),p=A(r.bottom,p))},this),m=t?this._matrix:Two.Utils.getComputedMatrix(this),g=m.multiply(h,d,1),v=m.multiply(f,d,1),y=m.multiply(f,p,1),x=m.multiply(h,p,1),d=w(g.y,v.y,y.y,x.y),h=w(g.x,v.x,y.x,x.x),f=A(g.x,v.x,y.x,x.x),p=A(g.y,v.y,y.y,x.y),{top:d,left:h,right:f,bottom:p,width:f-h,height:p-d}},noFill:function(){return _.each(this.children,function(t){t.noFill()}),this},noStroke:function(){return _.each(this.children,function(t){t.noStroke()}),this},subdivide:function(){var t=arguments;return _.each(this.children,function(e){e.subdivide.apply(e,t)}),this},flagReset:function(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),Two.Shape.prototype.flagReset.call(this),this}}),T.MakeObservable(T.prototype)}();